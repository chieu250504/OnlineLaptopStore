@{
    ViewBag.Title = "Danh sách đơn hàng";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

@model List<Laptop88_3.Controllers.OrderManagementViewModel>

<div class="order-container">
    <h2>📦 Danh sách đơn hàng</h2>
    @if (TempData["success"] != null)
    {
        <div class="alert alert-success">@TempData["success"]</div>
    }
    @if (TempData["error"] != null)
    {
        <div class="alert alert-danger">@TempData["error"]</div>
    }
    <table class="order-table">
        <thead>
            <tr>
                <th style="width:60px;">Mã</th>
                <th style="width:120px;">Người đặt</th>
                <th style="width:90px;">Ngày tạo</th>
                <th style="width:110px;">Trạng thái</th>
                <th style="width:250px;">Địa chỉ</th>
                <th style="width:110px;">SĐT</th>
                <th style="width:250px;">Sản phẩm</th>
                <th style="width:70px;">SL</th>
                <th style="width:100px;">Giá</th>
                <th style="width:100px;">Tổng cộng</th>
                <th style="width:140px;"></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var order in Model)
            {
                <tr>
                    <td>@order.OrderID</td>
                    <td>@order.Username</td>
                    <td>@order.OrderDate.ToString("dd/MM/yyyy")</td>
                    <td>
                        <span class="status @(order.Status.Contains("duyệt") ? "status-pending" : "status-done")">
                            @order.Status
                        </span>
                    </td>
                    <td class="truncate">@order.ShippingAddress</td>
                    <td>@order.PhoneShipping</td>

                    <td>
                        <table class="inner-table">
                            @foreach (var item in order.Items)
                            {
                                <tr class="@(item.IsGift ? "gift-row" : "")">
                                    <td class="truncate">@item.ProductName</td>
                                </tr>
                            }
                        </table>
                    </td>

                    <td class="text-center">
                        <table class="inner-table text-center">
                            @foreach (var item in order.Items)
                            {
                                <tr><td>@item.Quantity</td></tr>
                            }
                        </table>
                    </td>

                    <td>
                        <table class="inner-table text-right">
                            @foreach (var item in order.Items)
                            {
                                <tr>
                                    <td>@(item.UnitPrice == 0 ? "0 ₫" : item.UnitPrice.ToString("N0") + " ₫")</td>
                                </tr>
                            }
                        </table>
                    </td>

                    <td class="price-cell">@order.TotalAmount.ToString("N0") ₫</td>

                    <td class="icon-cell">
                        <a href="@Url.Action("DetailOrder", "OrderManagement", new { orderCode = order.ShippingCode })" >
                            <img src="~/Picture/Icon/detail.png" class="action-icon" title="Xem chi tiết" />
                        </a>
                        <a href="@Url.Action("ApproveOrder", "OrderManagement", new { id = order.OrderID })">
                            <img src="~/Picture/Icon/yes.png" class="action-icon" title="Duyệt đơn" />
                        </a>
                        <a href="@Url.Action("CancelOrder", "OrderManagement", new { id = order.OrderID })">
                            <img src="~/Picture/Icon/no.png" class="action-icon" title="Hủy đơn" />
                        </a>


                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>


